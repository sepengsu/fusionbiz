<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>전처리기 설정</title>
  <link rel="stylesheet" href="/frontend/preprocessor/style.css" />
</head>
<body>
  <div class="container">
    <h1>🧾 텍스트 전처리기</h1>

    <div class="section">
      <label for="processType">처리 유형 선택</label>
      <select id="processType">
        <option value="manual">메뉴얼</option>
        <option value="sql">SQL</option>
      </select>

      <label for="fileInput">텍스트 또는 PDF 파일 업로드</label>
      <input type="file" id="fileInput" accept=".txt,.pdf" />

      <label for="splitMethod">텍스트 분할 방법</label>
      <select id="splitMethod">
        <option>RecursiveCharacterTextSplitter</option>
        <option>CharacterTextSplitter</option>
        <option>MarkdownHeaderTextSplitter</option>
      </select>

      <label for="chunkSize">Chunk Size</label>
      <input type="range" id="chunkSize" min="100" max="2000" value="200" />
      <span id="chunkSizeValue">200</span>

      <label for="chunkOverlap">Chunk Overlap</label>
      <input type="range" id="chunkOverlap" min="0" max="500" value="0" />
      <span id="chunkOverlapValue">0</span>

      <label for="vectorType">벡터 저장소 유형</label>
      <select id="vectorType">
        <option>Chroma</option>
        <option>FAISS</option>
      </select>

      <label for="searchType">검색 유형</label>
      <select id="searchType">
        <option>similarity</option>
        <option>mmr</option>
      </select>

      <label for="topK">검색 결과 수(k)</label>
      <input type="range" id="topK" min="1" max="10" value="3" />
      <span id="topKValue">3</span>

      <label for="embeddingModel">임베딩 모델</label>
      <select id="embeddingModel">
        <option>sentence-transformers/all-MiniLM-L6-v2</option>
        <option>sentence-transformers/paraphrase-MiniLM-L6-v2</option>
        <option>sentence-transformers/multi-qa-MiniLM-L6-cos-v1</option>
        <option>sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2</option>
        <option>openai/text-embedding-3-small</option>
        <option>openai/text-embedding-ada-002</option>
      </select>

      <div class="button-container">
        <button onclick="processData()" id="processBtn">🚀 데이터 처리</button>
      </div>

      <div id="loading">⚙️ 처리 중입니다...</div>
      <div id="statusArea"></div>

      <div id="previewArea" class="preview-section" style="display: none;">
        <h3>📄 랜덤 청크 문서 미리보기</h3>
        <p><strong>📁 출처:</strong> <span id="sourceFile"></span></p>
        <div id="sampleContent" class="preview-content"></div>
      </div>
    </div>

    <!-- 🛠️ 로그 파일 업로드 영역 -->
    <div class="log-section">
      <h3>🛠️ 로그 파일 업로드 및 DB 저장</h3>
      <form id="log-upload-form" enctype="multipart/form-data">
        <input type="file" name="file" accept=".txt,.tsv,.csv" required />
        <button type="submit">업로드 및 저장</button>
      </form>
      <pre id="log-upload-result"></pre>
    </div>
  </div>

  <script src="/frontend/preprocessor/preprocessor.js"></script>
</body>
</html>
